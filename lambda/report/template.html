<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptocurrency Hourly Candles Report</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f5f7;
            color: #333;
        }
        .card h1 {
            font-size: 18px; /* Adjust the font size as desired */
            margin: 0; /* Optional: to ensure consistent spacing */
            font-weight: normal; /* Optional: to reduce the boldness */
            color: #333; /* Optional: adjust the color if needed */
        }

        .card p {
            font-size: 14px; /* Adjust to your preferred size */
            line-height: 1.6; /* Increase readability */
            margin: 10px 0; /* Add vertical spacing */
            color: #555; /* Subtle color to distinguish from headings */
        }

        /* Sticky header styling */
        .sticky-header {
            position: fixed;
            top: 0;
            width: 100%;
            background-color: #0074d9;
            color: white;
            padding: 10px 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
        }

        /* Title styling */
        .sticky-header h1 {
            margin: 0;
            font-size: 20px;
            cursor: pointer; /* Shows a pointer cursor when hovering over the text */
            transition: color 0.2s ease; /* Smooth transition for color */
        }

        /* Subtle hover effect for the title */
        .sticky-header h1:hover {
            color: #ffeb3b; /* Slight color change on hover */
        }

        /* Button styling */
        .sticky-header button {
            background-color: white;
            color: #0074d9;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
        }

        /* Button hover effect */
        .sticky-header button:hover {
            background-color: #f2f8ff;
        }

        .crypto-stats {
            font-size: 14px;
            line-height: 1.6;
            margin: 10px 0;
            color: #555;
        }

        .crypto-stats span {
            margin-right: 10px; /* Add space between items */
        }
        .header {
            text-align: center;
            margin-top: 60px; /* Adjust for sticky header space */
            margin-bottom: 20px;
        }
        table {
            width: 80%;
            margin: 0 auto;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        table th, table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
            font-size: 14px;
        }
        table th {
            background-color: #0074d9;
            color: white;
            font-weight: bold;
        }
        table tbody tr:hover {
            background-color: #f2f8ff;
            cursor: pointer;
        }
        .positive {
            color: green;
        }
        .negative {
            color: red;
        }
        .chart {
            text-align: center;
            margin-top: 20px;
        }
        .chart img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        .card {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        footer {
            text-align: center;
            margin-top: 20px;
            font-size: 12px;
            color: #aaa;
        }
        .table-container {
            overflow-x: auto;
            margin: 0 -20px;
        }
    </style>
</head>

<body>
    <!-- Sticky Header -->
    <div class="sticky-header">
         <h1 onclick="scrollToTop()">Cryptocurrency Report</h1>
    </div>

    <!-- Summary Table -->
    <div class="card">
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Symbol</th>
                        <th>Total Value (R$)</th>
                        <th>Variation (%)</th>
                        <th>Last Price</th>
                    </tr>
                </thead>
                <tbody>
                    {% for crypto in data|sort(attribute='value', reverse=True) %}
                    <tr onclick="scrollToCrypto('{{ crypto.symbol }}')">
                        <td>
                            <a href="#crypto-{{ crypto.symbol }}" style="text-decoration: none; color: #0074d9;">
                                {{ crypto.symbol }}
                            </a>
                        </td>
                        <td class="format-number">{{ crypto.value }}</td>
                        <td class="format-number {{ 'positive' if crypto.variation >= 0 else 'negative' }}">
                            {% if crypto.variation %}
                                {{ (crypto.variation * 100)|round(2) }}
                            {% else %}
                                {{ '-' }}
                            {% endif %}
                        </td>
                        <td class="format-number">{{ crypto.last }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Detailed Reports -->
    {% for crypto in data %}
    <div id="crypto-{{ crypto.symbol }}" class="card">
        <div class="header">
            <h1>{{ crypto.symbol }} - Hourly Candles Report</h1>
            <p class="crypto-stats">
                <span class="format-number">
                    <b>Value:</b> {{ crypto.value }}
                </span> |
                <span class="format-number">
                    <b>Variation:</b> {{ (crypto.variation * 100)|round(2) }}%
                </span> |
                <span class="format-number">
                    <b>Volume:</b> {{ crypto.vol }}
                </span> |
                <span class="format-number">
                    <b>Last Price:</b> {{ crypto.last }}
                </span>
            </p>

        </div>
        <div class="chart">
            <img src="data:image/png;base64,{{ crypto.chart_image }}" alt="Candle Chart for {{ crypto.symbol }}">
        </div>
    </div>
    <div style="page-break-after: always;"></div>
    {% endfor %}

    <footer>
        <a href="https://github.com/eduardofmanrique">https://github.com/eduardofmanrique</a>
    </footer>

    <script>
        // Scroll to top function
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Scroll to the specific crypto section
        function scrollToCrypto(symbol) {
            const element = document.getElementById(`crypto-${symbol}`);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Format numbers to Brazilian style
        const formatNumber = (number) => {
            return new Intl.NumberFormat('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(number);
        };

        // Apply formatting to all elements with the 'format-number' class
        document.querySelectorAll('.format-number').forEach((el) => {
            const num = parseFloat(el.textContent);
            if (!isNaN(num)) {
                el.textContent = formatNumber(num);
            }
        });
    </script>
</body>
</html>